<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Crying Obsidian Themed UI</title>
  <style>
    /* === Theme Colors (CSS Variables) === */
    :root {
      --bg-color: #0b0c10;            /* Near-black background */
      --accent-color: #8a2be2;        /* Purple accent (blueviolet) */
      --text-color: #d4d4f0;          /* Light text color */
    }
    /* Basic page styling */
    html { scroll-behavior: smooth; background: var(--bg-color); color: var(--text-color); font-family: sans-serif; }
    body {
      margin: 0;
      background: radial-gradient(at 30% 30%, rgba(138,43,226,0.2), transparent 50%),
                  radial-gradient(at 70% 70%, rgba(138,43,226,0.15), transparent 50%),
                  var(--bg-color);
      /* Two purple glow spots + solid bg */
      background-size: cover;
      overflow-x: hidden;
      animation: ambientGlow 20s infinite alternate;
    }
    /* Ambient background glow animation */
    @keyframes ambientGlow {
      0%   { background-position: 0% 0%,  100% 100%, center; }
      50%  { background-position: 10% 5%, 90%  95%,  center; }
      100% { background-position: 0% 0%,  100% 100%, center; }
    }
    /* === Sidebar Navigation === */
    #sidebar {
      position: fixed; top: 0; left: 0;
      width: 250px; height: 100%;
      background: #151528;              /* very dark purple/indigo */
      padding: 60px 20px 20px;          /* space at top for toggle button */
      box-shadow: 5px 0 15px rgba(0,0,0,0.8);
      transform: translateX(-260px);    /* hide off-screen */
      transition: transform 0.3s ease;  /* slide animation */
      z-index: 200;
    }
    #sidebar.open { transform: translateX(0); } /* Sidebar visible */
    #sidebar ul { list-style: none; padding: 0; margin: 0; }
    #sidebar li { margin: 15px 0; }
    #sidebar a {
      display: block; text-decoration: none;
      color: var(--text-color);
      font-weight: bold;
      padding: 8px 5px;
      border-radius: 4px;
      transition: background 0.3s, text-shadow 0.3s;
    }
    #sidebar a:hover {
      background: rgba(138,43,226,0.3);              /* purple highlight */
      text-shadow: 0 0 5px var(--accent-color);      /* glow text */
    }
    /* Overlay to dim page when sidebar is open */
    #overlay {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      z-index: 150;
    }
    #overlay.show { display: block; }
    /* === Top Controls (Menu and Sound Toggle) === */
    #menuToggle, #soundToggle {
      position: fixed; top: 15px;
      background: none; color: var(--accent-color);
      border: 2px solid var(--accent-color);
      padding: 5px 10px;
      font-size: 18px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s, color 0.2s;
      z-index: 300;
    }
    #menuToggle { left: 15px; }   /* hamburger menu button */
    #soundToggle { right: 15px; } /* sound on/off button */
    #menuToggle:hover, #soundToggle:hover {
      background: var(--accent-color);
      color: #fff;
      text-shadow: 0 0 5px var(--accent-color);
    }
    /* === Main Content Area === */
    #mainContent { 
      max-width: 1200px; margin: 0 auto; 
      padding: 60px 20px 40px;         /* top padding to avoid overlap with fixed header buttons */
    }
    section { margin-bottom: 60px; }
    section h2 {
      font-size: 1.5em;
      border-bottom: 2px solid var(--accent-color);
      padding-bottom: 5px;
      margin-bottom: 15px;
    }
    /* === Search Section === */
    #searchSection input[type=text] {
      width: 60%; max-width: 300px;
      padding: 8px;
      border: 2px solid #333;
      border-radius: 4px;
      background: #222;            /* input background */
      color: var(--text-color);
      margin-right: 5px;
    }
    #searchSection input::placeholder { color: #888; }
    #searchSection button {
      padding: 8px 12px;
      background: var(--accent-color);
      color: #fff;
      border: none;
      border-radius: 4px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }
    #searchSection button:hover { background: #6c1bbd; } /* darker purple */
    #searchResults {
      margin-top: 10px;
    }
    .result-category { 
      font-weight: bold; margin-top: 10px;
    }
    #searchResults ul { list-style: none; padding: 0; margin: 5px 0 15px; }
    #searchResults li {
      padding: 4px 0;
      border-bottom: 1px solid #333;
    }
    /* === Price Graph Section === */
    #graphSection { text-align: center; }
    .graph-controls { margin-bottom: 10px; }
    .graph-controls button {
      margin: 0 5px;
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      background: #333;
      color: var(--text-color);
      cursor: pointer;
      transition: background 0.3s, box-shadow 0.3s;
    }
    .graph-controls button:hover { 
      background: var(--accent-color); color: #fff;
    }
    .graph-controls button.active {
      background: var(--accent-color); color: #fff;
      box-shadow: 0 0 10px var(--accent-color);
    }
    #priceChart {
      width: 100%; max-width: 600px;
      height: 300px;
      background: #222;
      border: 2px solid #333;
      border-radius: 4px;
      display: block;
      margin: 0 auto;   /* center the canvas */
    }
    /* === Top Items Section (Margins & Variations) === */
    .subsection { margin-top: 30px; }
    .subsection h3 { 
      font-size: 1.2em;
      margin-bottom: 8px;
    }
    #topItemsSection ul { list-style: none; padding: 0; margin: 0; }
    #topItemsSection li {
      display: flex; justify-content: space-between; align-items: center;
      padding: 8px 5px;
      border-bottom: 1px solid #333;
      transition: background 0.3s, text-shadow 0.3s;
    }
    #topItemsSection li:hover {
      background: rgba(138,43,226,0.2);
      text-shadow: 0 0 5px var(--accent-color);
    }
    #topItemsSection li .value {
      color: var(--accent-color);
      font-weight: bold;
    }
    /* Controls for lists */
    #sortMarginBtn, #variationRangeSelect {
      margin: 5px 0 15px;
      padding: 5px 8px;
      border-radius: 4px;
      border: 1px solid #333;
      background: #222;
      color: var(--text-color);
      cursor: pointer;
      font: inherit;
    }
    /* === Profit Calculator Section === */
    #calculatorSection label {
      display: block;
      margin: 10px 0;
      font-size: 1em;
    }
    #calculatorSection input {
      padding: 5px;
      width: 200px;
      border: 2px solid #333;
      border-radius: 4px;
      background: #222;
      color: var(--text-color);
      margin-left: 10px;
    }
    #calculatorSection button {
      margin-top: 15px;
      padding: 8px 12px;
      background: var(--accent-color);
      color: #fff;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }
    #calculatorSection button:hover { background: #6c1bbd; }
    #profitResult {
      margin-top: 15px;
      font-weight: bold;
      font-size: 1.1em;
      min-height: 24px;
    }
    /* flash animation for result update */
    @keyframes flash {
      0%   { background-color: rgba(138,43,226,0.5); }
      100% { background-color: transparent; }
    }
    .flash { animation: flash 1s ease-out; }
    /* === Responsive Adjustments === */
    @media (max-width: 600px) {
      #sidebar { width: 200px; transform: translateX(-210px); }
      #mainContent { padding: 60px 15px 30px; }
      /* Smaller font or canvas adjustments if needed */
      #priceChart { height: 200px; }
      #menuToggle, #soundToggle { font-size: 16px; padding: 5px 8px; }
      #searchSection input { width: 100%; max-width: none; margin: 0 0 10px; }
    }
    /* Hover/focus glow for interactive elements (general) */
    button:hover, input:focus, select:focus {
      outline: none;
      box-shadow: 0 0 5px var(--accent-color);
    }
  </style>
</head>
<body>
  <!-- Sidebar toggle and sound toggle buttons -->
  <button id="menuToggle">â˜°</button>
  <button id="soundToggle">ðŸ”‡</button>

  <!-- Sidebar Navigation Menu -->
  <div id="sidebar">
    <ul>
      <li><a href="#searchSection">Search</a></li>
      <li><a href="#graphSection">Graphs</a></li>
      <li><a href="#topItemsSection">Top Items</a></li>
      <li><a href="#calculatorSection">Profit Calculator</a></li>
    </ul>
  </div>
  <div id="overlay"></div>

  <!-- Main Content Sections -->
  <div id="mainContent">
    <!-- Search Section -->
    <section id="searchSection">
      <h2>Search</h2>
      <input type="text" id="searchInput" placeholder="Search for an item..." />
      <button id="searchBtn">Search</button>
      <div id="searchResults"></div>
    </section>

    <!-- Price Graph Section -->
    <section id="graphSection">
      <h2>Price Graph</h2>
      <div class="graph-controls">
        <button data-range="1H">1 Hour</button>
        <button data-range="1D" class="active">1 Day</button>
        <button data-range="1W">1 Week</button>
        <button data-range="1Y">1 Year</button>
        <button data-range="ALL">All Time</button>
      </div>
      <canvas id="priceChart" width="600" height="300"></canvas>
    </section>

    <!-- Top Items Section (Margins & Variations) -->
    <section id="topItemsSection">
      <h2>Top Items</h2>
      <!-- Top Margins Subsection -->
      <div class="subsection">
        <h3>Top 10 Items with Highest Margins</h3>
        <button id="sortMarginBtn">Sort Ascending</button>
        <ul id="marginList"></ul>
      </div>
      <!-- Top Variations Subsection -->
      <div class="subsection">
        <h3>Top 10 Items with Highest Price Variations</h3>
        <div>Time Range:
          <select id="variationRangeSelect">
            <option value="1H">1 Hour</option>
            <option value="1D" selected>1 Day</option>
            <option value="1W">1 Week</option>
            <option value="1Y">1 Year</option>
            <option value="ALL">All Time</option>
          </select>
        </div>
        <ul id="variationList"></ul>
      </div>
    </section>

    <!-- Profitability Calculator Section -->
    <section id="calculatorSection">
      <h2>Profitability Calculator</h2>
      <label for="coinsInput">Coins: 
        <input type="number" id="coinsInput" value="0" />
      </label>
      <label for="diffInput">Difficulty: 
        <input type="number" id="diffInput" value="0" />
      </label>
      <button id="calcBtn">Calculate Profit</button>
      <div id="profitResult"></div>
    </section>
  </div>

  <!-- Background Music Audio (initially paused) -->
  <audio id="bgMusic" src="https://cdn.pixabay.com/download/audio/2022/10/14/audio_9f8b1101b0.mp3?filename=mystic-realm-of-minecraft-235545.mp3" loop></audio>

  <script>
    // Grab reference to sidebar and overlay
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const menuToggle = document.getElementById('menuToggle');
    // Toggle sidebar open/close
    menuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('open');
      overlay.classList.toggle('show');
    });
    // Clicking overlay closes sidebar
    overlay.addEventListener('click', () => {
      sidebar.classList.remove('open');
      overlay.classList.remove('show');
    });
    // Close sidebar when a menu link is clicked (useful for mobile)
    document.querySelectorAll('#sidebar a').forEach(link => {
      link.addEventListener('click', () => {
        sidebar.classList.remove('open');
        overlay.classList.remove('show');
      });
    });

    // Sound toggle for background music
    const bgMusic = document.getElementById('bgMusic');
    const soundToggle = document.getElementById('soundToggle');
    soundToggle.addEventListener('click', () => {
      if (bgMusic.paused) {
        bgMusic.volume = 0.5;   // set volume (0.0 to 1.0)
        bgMusic.play();
        soundToggle.textContent = 'ðŸ”Š';  // change icon to sound on
      } else {
        bgMusic.pause();
        soundToggle.textContent = 'ðŸ”‡';  // change icon to muted
      }
    });

    // Accent color value for canvas drawing (from CSS variable)
    const accentColor = getComputedStyle(document.documentElement).getPropertyValue('--accent-color').trim();

    // Price Graph Data (dummy values) and Drawing Logic
    const graphData = {
      '1H': Array.from({length: 60}, () => Math.floor(Math.random()*50) + 50),  // e.g. 60 points (last 60 minutes)
      '1D': Array.from({length: 24}, () => Math.floor(Math.random()*50) + 50),  // 24 hourly points
      '1W': Array.from({length: 7},  () => Math.floor(Math.random()*50) + 50),  // 7 daily points
      '1Y': Array.from({length: 12}, () => Math.floor(Math.random()*50) + 50),  // 12 monthly points
      'ALL': Array.from({length: 30}, () => Math.floor(Math.random()*50) + 50)  // 30 generic points
    };
    const canvas = document.getElementById('priceChart');
    const ctx = canvas.getContext('2d');
    function drawGraph(range) {
      const data = graphData[range];
      const maxVal = Math.max(...data);
      const minVal = Math.min(...data);
      const len = data.length;
      // Clear canvas
      ctx.fillStyle = '#222';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      // Draw line
      ctx.beginPath();
      const x0 = 0;
      const y0 = canvas.height - ((data[0] - minVal) / (maxVal - minVal || 1) * canvas.height);
      ctx.moveTo(x0, y0);
      ctx.strokeStyle = accentColor;
      ctx.lineWidth = 2;
      ctx.shadowBlur = 10;
      ctx.shadowColor = accentColor;
      data.forEach((val, index) => {
        const x = (index / (len - 1)) * canvas.width;
        const y = canvas.height - ((val - minVal) / (maxVal - minVal || 1) * canvas.height);
        ctx.lineTo(x, y);
      });
      ctx.stroke();
      ctx.shadowBlur = 0; // disable glow for points
      ctx.fillStyle = accentColor;
      // Draw points
      data.forEach((val, index) => {
        const x = (index / (len - 1)) * canvas.width;
        const y = canvas.height - ((val - minVal) / (maxVal - minVal || 1) * canvas.height);
        ctx.beginPath();
        ctx.arc(x, y, 3, 0, 2 * Math.PI);
        ctx.fill();
      });
    }
    // Initial graph for 1 Day
    let currentRange = '1D';
    drawGraph(currentRange);
    // Handle range button clicks
    document.querySelectorAll('.graph-controls button').forEach(btn => {
      btn.addEventListener('click', () => {
        // update active button styling
        document.querySelectorAll('.graph-controls button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        // draw new graph
        currentRange = btn.getAttribute('data-range');
        drawGraph(currentRange);
      });
    });

    // Top Items Data (dummy values)
    const topMargins = [
      { item: 'Dragon Egg',       value: 50000 },
      { item: 'Netherite Ingot',  value: 32000 },
      { item: 'Enchanted Apple',  value: 25000 },
      { item: 'Wither Skull',     value: 18000 },
      { item: 'Totem of Undying', value: 15000 },
      { item: 'Elytra',           value: 12000 },
      { item: 'Beacon',           value: 10000 },
      { item: 'Shulker Shell',    value:  8000 },
      { item: 'Diamond Block',    value:  6000 },
      { item: 'Heart of the Sea', value:  5000 }
    ];
    const topVariations = {
      '1H': [
        { item: 'Netherite Ingot',  value: '3%' },
        { item: 'Enchanted Apple',  value: '2.5%' },
        { item: 'Beacon',          value: '2%' },
        { item: 'Dragon Egg',      value: '1.8%' },
        { item: 'Elytra',          value: '1.5%' },
        { item: 'Totem of Undying',value: '1.4%' },
        { item: 'Wither Skull',    value: '1.2%' },
        { item: 'Heart of the Sea',value: '1%' },
        { item: 'Shulker Shell',   value: '0.8%' },
        { item: 'Diamond Block',   value: '0.5%' }
      ],
      '1D': [
        { item: 'Dragon Egg',       value: '15%' },
        { item: 'Netherite Ingot',  value: '12%' },
        { item: 'Elytra',           value: '10%' },
        { item: 'Enchanted Apple',  value: '9%' },
        { item: 'Beacon',           value: '8%' },
        { item: 'Totem of Undying', value: '7%' },
        { item: 'Wither Skull',     value: '6%' },
        { item: 'Heart of the Sea', value: '5%' },
        { item: 'Diamond Block',    value: '4%' },
        { item: 'Shulker Shell',    value: '3%' }
      ],
      '1W': [
        { item: 'Dragon Egg',       value: '30%' },
        { item: 'Netherite Ingot',  value: '25%' },
        { item: 'Elytra',           value: '20%' },
        { item: 'Enchanted Apple',  value: '18%' },
        { item: 'Beacon',           value: '15%' },
        { item: 'Totem of Undying', value: '12%' },
        { item: 'Wither Skull',     value: '10%' },
        { item: 'Heart of the Sea', value: '8%' },
        { item: 'Diamond Block',    value: '6%' },
        { item: 'Shulker Shell',    value: '5%' }
      ],
      '1Y': [
        { item: 'Dragon Egg',       value: '90%' },
        { item: 'Netherite Ingot',  value: '75%' },
        { item: 'Elytra',           value: '60%' },
        { item: 'Enchanted Apple',  value: '55%' },
        { item: 'Beacon',           value: '50%' },
        { item: 'Totem of Undying', value: '45%' },
        { item: 'Wither Skull',     value: '40%' },
        { item: 'Heart of the Sea', value: '30%' },
        { item: 'Diamond Block',    value: '25%' },
        { item: 'Shulker Shell',    value: '20%' }
      ],
      'ALL': [
        { item: 'Dragon Egg',       value: '150%' },
        { item: 'Netherite Ingot',  value: '120%' },
        { item: 'Elytra',           value: '100%' },
        { item: 'Enchanted Apple',  value: '90%' },
        { item: 'Beacon',           value: '80%' },
        { item: 'Totem of Undying', value: '70%' },
        { item: 'Wither Skull',     value: '60%' },
        { item: 'Heart of the Sea', value: '50%' },
        { item: 'Diamond Block',    value: '40%' },
        { item: 'Shulker Shell',    value: '30%' }
      ]
    };

    // Render Top Margins list
    const marginListEl = document.getElementById('marginList');
    function renderMargins(list) {
      marginListEl.innerHTML = ''; // clear current list
      list.forEach(entry => {
        const li = document.createElement('li');
        li.innerHTML = entry.item + ' <span class="value">' + entry.value + ' coins</span>';
        marginListEl.appendChild(li);
      });
    }
    // Initial render (assuming topMargins is already in descending order)
    renderMargins(topMargins);

    // Sorting toggle for margins
    let marginsAscending = false;
    const sortMarginBtn = document.getElementById('sortMarginBtn');
    sortMarginBtn.addEventListener('click', () => {
      marginsAscending = !marginsAscending;
      if (marginsAscending) {
        // sort ascending by value
        topMargins.sort((a, b) => a.value - b.value);
        sortMarginBtn.textContent = 'Sort Descending';
      } else {
        // sort descending
        topMargins.sort((a, b) => b.value - a.value);
        sortMarginBtn.textContent = 'Sort Ascending';
      }
      renderMargins(topMargins);
    });

    // Render Top Variations list for a given range
    const variationListEl = document.getElementById('variationList');
    function renderVariations(range) {
      variationListEl.innerHTML = '';
      topVariations[range].forEach(entry => {
        const li = document.createElement('li');
        li.innerHTML = entry.item + ' <span class="value">' + entry.value + '</span>';
        variationListEl.appendChild(li);
      });
    }
    // Initial render for default selected range (1D)
    const variationSelect = document.getElementById('variationRangeSelect');
    renderVariations(variationSelect.value);
    // Update on range change
    variationSelect.addEventListener('change', () => {
      renderVariations(variationSelect.value);
    });

    // Search functionality: filter items in both lists
    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    const searchResults = document.getElementById('searchResults');
    function performSearch() {
      const query = searchInput.value.trim().toLowerCase();
      searchResults.innerHTML = '';
      if (!query) return;
      // Find matches in margins list
      const marginMatches = topMargins.filter(entry => entry.item.toLowerCase().includes(query));
      // Find matches in variations (across all ranges)
      const variationMatches = [];
      for (const range in topVariations) {
        topVariations[range].forEach(entry => {
          if (entry.item.toLowerCase().includes(query)) {
            variationMatches.push({ item: entry.item, value: entry.value, range: range });
          }
        });
      }
      if (marginMatches.length > 0) {
        const cat = document.createElement('div');
        cat.className = 'result-category';
        cat.textContent = 'Matches in Highest Margins:';
        searchResults.appendChild(cat);
        const ul = document.createElement('ul');
        marginMatches.forEach(entry => {
          const li = document.createElement('li');
          li.textContent = `${entry.item} (Margin: ${entry.value} coins)`;
          ul.appendChild(li);
        });
        searchResults.appendChild(ul);
      }
      if (variationMatches.length > 0) {
        const cat = document.createElement('div');
        cat.className = 'result-category';
        cat.textContent = 'Matches in Price Variations:';
        searchResults.appendChild(cat);
        const ul = document.createElement('ul');
        variationMatches.forEach(entry => {
          const li = document.createElement('li');
          li.textContent = `${entry.item} (Variation: ${entry.value} in ${entry.range})`;
          ul.appendChild(li);
        });
        searchResults.appendChild(ul);
      }
      if (marginMatches.length === 0 && variationMatches.length === 0) {
        searchResults.textContent = 'No items found.';
      }
    }
    searchBtn.addEventListener('click', performSearch);
    searchInput.addEventListener('keyup', (e) => {
      if (e.key === 'Enter') performSearch();
    });

    // Profitability Calculator logic
    const coinsInput = document.getElementById('coinsInput');
    const diffInput = document.getElementById('diffInput');
    const calcBtn = document.getElementById('calcBtn');
    const profitResult = document.getElementById('profitResult');
    calcBtn.addEventListener('click', () => {
      const coins = parseFloat(coinsInput.value) || 0;
      const diff  = parseFloat(diffInput.value) || 0;
      const profit = coins * diff;
      profitResult.textContent = "Estimated Profit: " + profit.toFixed(2);
      // Trigger a flash animation for feedback
      profitResult.classList.remove('flash');
      void profitResult.offsetWidth;  // reflow trick to restart CSS animation
      profitResult.classList.add('flash');
    });
  </script>
</body>
</html>
